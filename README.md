# Addi Provider - VSCode 扩展

Addi Provider 是一个 Visual Studio Code 扩展，允许您为 Github Copilot 添加自定义 AI 供应商和模型。通过这个扩展，您可以轻松管理和配置多个 AI 供应商及其模型，以便在开发过程中从统一入口快捷使用。

## 功能

- **供应商管理**: 添加、编辑和删除 AI 供应商，支持详细参数配置
- **模型管理**: 为每个供应商添加、编辑和删除 AI 模型
- **模型切换**: 一键切换 Copilot 中使用的 AI 模型
- **配置导入/导出**: 备份和恢复您的供应商和模型配置
- **自定义设置**: 配置默认的模型参数，如最大输入/输出 Token 数和默认版本
- **直观的用户界面**: 通过侧边栏树状视图轻松管理所有配置
- **上下文菜单**: 右键点击供应商或模型可以快速访问各种功能
- **模型调试面板**: 在模型上下文菜单中点击“使用模型”即可打开调试 Playground，实时测试请求并查看日志

## 要求

- Visual Studio Code 1.104.0 或更高版本
- GitHub Copilot 个人计划

> [!TIP]
> Edit/Agent 模式使用自定义 AI 模型需要 GitHub Copilot Pro 及以上计划，Free 版本仅支持内置模型和 Ask 模式。
> 请确保您已订阅相关内容，以使用此扩展自定义功能。

## 安装

1. 打开 Visual Studio Code
2. 按 `Ctrl+P` (Windows/Linux) 或 `Cmd+P` (macOS) 打开命令面板
3. 输入 `ext install addi`
4. 点击 "安装" 按钮
5. 安装完成后，重新启动 VS Code

## 使用方法

### 基本操作

1. 点击活动栏中的 "Addi" 图标打开侧边栏（或通过 Copilot 选择模型列表 → 管理模型 → Addi Settings 按钮）
2. 在侧边栏中，您可以查看所有已添加的供应商和模型并进行管理
3. 使用视图标题栏中的按钮添加供应商、导出配置、导入配置或打开设置

### 添加供应商

1. 点击侧边栏标题栏中的 "添加供应商" 按钮（+ 图标）
2. 依次填写以下参数：
   - **名称**（必填）：供应商的名称，例如 "OpenAI"
   - **描述**（可选）：供应商的描述信息，例如 "提供 GPT 系列模型"
   - **网站**（可选）：供应商的官方网站 URL，例如 "https://openai.com"
   - **API 端点**（可选）：供应商的 API 端点 URL，例如 "https://api.openai.com/v1"
   - **API 密钥**（可选）：访问供应商 API 所需的密钥，输入时以密码形式显示
3. 完成所有输入后，新供应商将出现在列表中

### 编辑供应商

1. 右键点击要编辑的供应商
2. 选择 "编辑" 选项（铅笔图标）
3. 修改所需信息并保存

### 快速编辑 API 密钥

1. 在供应商列表中，找到要编辑 API 密钥的供应商
2. 点击供应商右侧的密钥图标（🔑）
3. 在弹出的对话框中输入新的 API 密钥
4. 点击确认保存

### 添加模型

1. 右键点击要添加模型的供应商
2. 选择 "添加模型" 选项（+ 图标）
3. 依次填写以下参数：
   - **id**（必填）：模型的唯一标识符，例如 "gpt-4"
   - **名称**（选填）：模型的名称，默认与 ID 相同，例如 "GPT-4"
   - **家族**（选填）：模型家族，例如 "GPT" 或 "openai"
   - **版本**（选填）：模型版本，例如 "4.0"
   - **最大输入 Token 数**（选填）：模型可接受的最大输入 Token 数，例如 "8192"
   - **最大输出 Token 数**（选填）：模型可生成的最大输出 Token 数，例如 "4096"
4. 完成所有输入后，新模型将添加到指定供应商下

### 编辑模型

1. 右键点击要编辑的模型
2. 选择 "编辑" 选项（铅笔图标）
3. 修改所需信息并保存

### 查看模型详情

1. 将鼠标悬停在模型上
2. 工具提示将显示模型的详细信息，包括名称、家族、版本、最大输入/输出 Token 数等

### 使用模型（切换 Copilot 当前模型）

1. 在模型列表中，找到要使用的模型
2. 点击模型右侧的使用按钮（▶️）
3. 将会打开模型调试面板，您可以在其中输入提示词、调整温度等参数并发送测试请求
4. 面板右侧提供调用日志，方便排查请求与响应的原始载荷
5. 调试确认无误后，您即可在 Copilot 中使用该模型

> **注意**：要调用模型，必须确保其供应商已配置 API 密钥与端点。调试面板会提示调用结果或错误信息。

### 模型调试面板

调试面板提供一个交互式 Playground：

- 在顶部输入提示词，调整温度后点击“发送请求”即可测试模型响应
- 主视图展示最近的对话轮次与耗时，便于快速验证模型输出
- 右侧日志区域记录每次请求的载荷与响应，可导出为 JSON 文件或清空重试
- 支持在同一面板连续测试不同提示词，历史会话会自动追加

### 删除供应商或模型

1. 右键点击要删除的供应商或模型
2. 选择 "删除" 选项
3. 确认删除操作

### 导出配置

1. 点击侧边栏标题栏中的 "导出配置" 按钮
2. 选择保存位置和文件名
3. 配置将以 JSON 格式保存

### 导入配置

1. 点击侧边栏标题栏中的 "导入配置" 按钮
2. 选择之前导出的配置文件
3. 确认是否覆盖现有配置

## 扩展设置

此扩展贡献了以下设置，您可以在 VS Code 设置中修改：

- `addi.defaultMaxInputTokens`: 默认最大输入 Token 数 (默认: 4096)
- `addi.defaultMaxOutputTokens`: 默认最大输出 Token 数 (默认: 1024)
- `addi.defaultModelVersion`: 默认模型版本 (默认: "1.0.0")

要修改这些设置：

1. 打开 VS Code 设置 (`Ctrl+,` 或 `Cmd+,`)
2. 搜索 "addi"
3. 修改所需设置
4. 或者，点击侧边栏标题栏中的 "打开设置" 按钮

## 配置文件格式

导出的配置文件使用 JSON 格式，结构如下：

```json
[
  {
    "id": "供应商唯一ID",
    "name": "供应商名称",
    "description": "供应商描述",
    "website": "供应商网站",
    "apiEndpoint": "API端点URL",
    "apiKey": "API密钥",
    "models": [
      {
        "id": "模型唯一ID",
        "name": "模型名称",
        "family": "模型家族",
        "version": "模型版本",
        "maxInputTokens": "最大输入Token数",
        "maxOutputTokens": "最大输出Token数"
      }
    ]
  }
]
```

## 参数说明

### 供应商参数

| 参数     | 必填 | 说明                                   | 示例                      |
| -------- | ---- | -------------------------------------- | ------------------------- |
| 名称     | 是   | 供应商的名称，用于显示和识别           | OpenAI                    |
| 描述     | 否   | 供应商的描述信息，显示在供应商名称旁边 | 提供 GPT 系列模型         |
| 网站     | 否   | 供应商的官方网站 URL                   | https://openai.com        |
| API 端点 | 否   | 供应商的 API 端点 URL                  | https://api.openai.com/v1 |
| API 密钥 | 否   | 访问供应商 API 所需的密钥              | sk-...                    |

### 模型参数

| 参数              | 必填 | 说明                          | 示例       |
| ----------------- | ---- | ----------------------------- | ---------- |
| 名称              | 是   | 模型的名称，用于显示和识别    | GPT-4      |
| 家族              | 是   | 模型家族，用于分组相关模型    | GPT/openai |
| 版本              | 是   | 模型版本号                    | 4.0        |
| 最大输入 Token 数 | 是   | 模型可接受的最大输入 Token 数 | 8192       |
| 最大输出 Token 数 | 是   | 模型可生成的最大输出 Token 数 | 4096       |

## 常见问题

### Q: 为什么我添加的模型在 Copilot 中不可见？

A: 请确保：

1. 您已为供应商配置了 API 密钥
2. 您使用的是 GitHub Copilot 个人计划
3. 模型已正确添加并保存

### Q: 如何知道我的模型是否正在使用中？

A: 当您成功切换模型后，会收到确认消息。此外，您可以在 Copilot 聊天界面的模型选择器中查看当前选中的模型。

### Q: 我可以添加多少个供应商和模型？

A: 扩展对供应商和模型数量没有硬性限制，但建议根据您的实际需求合理添加。

## 发布说明

### 0.0.1

- 初始版本发布
- 支持添加、编辑和删除 AI 供应商和模型
- 支持配置导入/导出功能
- 添加自定义设置选项
- 实现直观的用户界面和上下文菜单

### 最新版本

- 添加供应商详细参数配置（名称、描述、网站、API 端点、API 密钥）
- 实现 API 密钥快速编辑功能
- 添加模型详情查看功能
- 实现模型快速切换功能
- 改进用户界面和交互体验
- 修复与 VS Code Copilot 的兼容性问题

## 故障排除

如果您遇到任何问题，请尝试以下步骤：

1. 重新启动 VS Code
2. 禁用然后重新启用扩展
3. 检查 VS Code 控制台是否有错误消息
4. 确保您使用的是支持的 VS Code 版本
5. 确保您已为供应商配置了有效的 API 密钥

## 支持和反馈

如果您有任何问题、建议或功能请求，请通过以下方式联系我们：

- 在 GitHub 上创建问题: [Addi AI Issues](https://github.com/your-username/addi/issues)

## 开发

如果您想为这个项目做贡献，请按照以下步骤操作：

1. Fork 此仓库
2. 创建您的功能分支 (`git checkout -b feature/amazing-feature`)
3. 提交您的更改 (`git commit -m 'Add some amazing feature'`)
4. 推送到分支 (`git push origin feature/amazing-feature`)
5. 创建 Pull Request

## 打包 VSIX（vsce）

您可以使用 vsce 将此扩展打包为 .vsix 文件，方便离线安装或发布。

前置准备：

- 在 `package.json` 中设置 `publisher` 字段（本项目已设置为 `addi`）。
- 已安装 Node.js 和 npm。

两种方式使用 vsce：

1) 使用项目内依赖（推荐）

- 我们在 devDependencies 中加入了 `vsce`。执行打包脚本：

```powershell
npm install ; npm run vsix
```

2) 使用 npx 临时执行（可选）

```powershell
npm run package ; npx vsce package
```

脚本会先运行 `webpack` 生成 `dist/extension.js`，随后使用 `vsce package` 生成 VSIX 包（如 `addi-0.0.1.vsix`）。

常见问题：

- 缺少 `publisher`：请在 `package.json` 顶层添加 `"publisher": "your-publisher"`。
- 包体过大：请检查根目录 `.vscodeignore` 是否正确排除了 `src/`、`test/`、`.vscode/`、`node_modules/` 等不需要的内容。
- 需要签名/发布到 Marketplace：请参考 vsce 文档执行 `vsce login <publisher>` 后再 `vsce publish`。

## 许可证

本项目采用 MIT 许可证 - 有关详细信息，请查看 [LICENSE](LICENSE) 文件。

## 免责声明

使用本项目时，您需自行承担风险。我们不对因使用本项目而导致的任何直接或间接损失负责。
